<!DOCTYPE html>
<html>
	
	    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <meta content="javaee软件设计的基本原则" name="description">
  
  
    <meta name="keywords" content="javaee软件设计的基本原则,开闭原则,java,kinglyjn">
  
  <meta name="author" content="KinglyJn">

  <title>
    
        KinglyJn|javaee软件设计的基本原则
    
  </title>
  <!-- favicon -->
  <link rel="shortcut icon" href="static/img/favicon.ico">


  <!-- Third-party CSS -->
  <link href="/bower_components/normalize-css/normalize.min.css" rel="stylesheet">
  <link href="/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/bower_components/animate.css/animate.min.css" rel="stylesheet">
  <link href="/bower_components/components-font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="/static/font-mfizz/font-mfizz.css" rel="stylesheet">
  <!-- <link href="/bower_components/toastr/toastr.min.css" rel="stylesheet"> -->
  <link href="/bower_components/jquery.gritter/css/jquery.gritter.css" rel="stylesheet">
  <link rel="stylesheet" href="/search/css/cb-search.css">

  <!-- Custom styles for this template -->
  <link href="/static/css/style.min.css" rel="stylesheet">
  <link href="/static/css/pygments.css" rel="stylesheet">

  <!-- Scripts -->
  <script src="/bower_components/jquery/dist/jquery.min.js"></script>
  <script src="/search/js/bootstrap3-typeahead.min.js"></script>

  <!-- cb-search -->
  <script src="/search/js/cb-search.js"></script>
  <script>
    $(function(){
        $("pre").css('display','block');
    });
  </script>
  <!-- Mainly scripts -->
  <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
  <script src="/bower_components/metisMenu/dist/metisMenu.min.js"></script>
  <script src="/bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>

  <!-- Peity -->
  <script src="/bower_components/peity/jquery.peity.min.js"></script>

  <script src="/bower_components/PACE/pace.min.js"></script>
  <script src="/bower_components/wow/dist/wow.min.js"></script>
  <!-- Custom and plugin javascript -->
  <script src="/static/js/inspinia.js"></script>

  <!-- Rickshaw -->
  <script src="/bower_components/rickshaw/vendor/d3.v3.js"></script>
  <script src="/bower_components/rickshaw/rickshaw.min.js"></script>


  <!-- jPages -->
  <script src="/static/js/jPages.js"></script>
  <script src="/static/js/js.js"></script>
  <script type="text/javascript">
        $(function(){
          /* initiate the plugin */
          $("div.pag-holder").jPages({
              containerID  : "pag-itemContainer",
              perPage      : 10,  /* num of items per page */
              startPage    : 1,
              startRange   : 1,
              midRange     : 3,
              endRange     : 1
          });

          $("div.pag-jump button").click(function(){
            var page = parseInt($("div.pag-jump input").val());
            $("div.pag-holder").jPages(page);
          });

          $("div.pag-jump input").on("keypress", function(){
            var e=e||window.event;
            if (e.keyCode == 13) {
                var page = parseInt($("div.pag-jump input").val());
                $("div.pag-holder").jPages(page);
            } 
          });
      });
  </script>

<!-- GrowingIO -->

  <script>
    var _vds = _vds || [];
    window._vds = _vds;
    (function(){
      _vds.push(['setAccountId', 'a49d4901c7853da9']);
      (function() {
        var vds = document.createElement('script');
        vds.type='text/javascript';
        vds.async = true;
        vds.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'dn-growing.qbox.me/vds.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(vds, s);
      })();
    })();
  </script>


</head>

	


<body id="page-top" class="landing-page">

	
	    

<!--修复手机端横轴方向左右滑动BUG-->
<style type="text/css">
    .landing-page .row {
        margin-left: 0px;
        margin-right: 0px;
    }
</style>

<div class="search-tool"
      style="position: fixed; top: 0px ; bottom: 0px; left: 0px; right:  0px; opacity: 0.95; background-color: #111111; z-index: 9999; display: none;">
    <input type="text" class="form-control search-content" id="search-content" style="position: fixed; top: 60px" placeholder="Search Blog">

    <div style="position: fixed; top: 16px; right: 16px; z-index: 9999;">
        <img src="/search/img/cb-close.png" id="close-btn"/>
    </div>
</div>

<div style="position: fixed; right: 16px; bottom: 20px; z-index: 9999;">
    <img src="/search/img/cb-search.png"  id="search-btn"  title="Double click Ctrl"/>
</div>

<div class="navbar-wrapper">
        <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header page-scroll">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">KinglyJn</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a class="page-scroll" href="/blog/"></a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/blog/">Blog</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/linux/">Linux</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/cloud/">Cloud</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/java/">Java</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/c/">C</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/py/">Py</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/php/">PHP</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/db/">DB</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/htmlx/">HTMLX</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/life/">Life</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/art/">Art</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/other/">Other</a></li>
                        
                    </ul>
                </div>
            </div>
        </nav>
</div>
<div id="inSlider" class="carousel carousel-fade" data-ride="carousel">
    <div style="position:absolute;float:left;left:25%;z-index:15;width:50%;margin-bottom:18%;bottom:0;text-align:center;list-style:none;">
        <span style="color:white;font-size:24px;">以平实之心写作</span><br>
        <span style="color:white;font-size:13px;">writing with simple heart ♬. </span>
    </div>
    <!--
    <ol class="carousel-indicators">
        <li data-target="#inSlider" data-slide-to="0" class="active"></li>
        <li data-target="#inSlider" data-slide-to="1"></li>
    </ol>
    -->
    <div class="carousel-inner" role="listbox">
        <div class="item active">
            <div class="container">
                <div class="carousel-caption">
                </div>
                <div class="carousel-image wow zoomIn">
                    <!-- <img src="static/img/landing/laptop.png" alt="laptop"/> -->
                </div>
            </div>
            <!-- Set background for slide in css -->
            <div class="header-back blog-one"></div>
        </div>
        <!--
        <div class="item">
            <div class="container">
                <div class="carousel-caption blank">
                </div>
            </div>
            Set background for slide in css
            <div class="header-back two"></div>
        </div>
        -->
    </div>
    <!--
    <a class="left carousel-control" href="#inSlider" role="button" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="right carousel-control" href="#inSlider" role="button" data-slide="next">
        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
    -->
</div>


	

    <div class="wrapper wrapper-content  animated fadeInRight article">
    <div class="row">
        <div class="col-lg-10 col-lg-offset-1">
            <div class="ibox">
                <div class="ibox-content">
                    <div class="pull-right">
                    	
                        	<button class="btn btn-white btn-xs" type="button">Java</button>
                        
                    </div>
                    <div class="text-center article-title" style="margin-bottom:50px;">
                        <h1>
                            javaee软件设计的基本原则
                        </h1>
                        <a href="http://www.keyllo.com/studio/">
                            <span class="text-muted"><i class="fa fa-user"></i> KinglyJn</span>
                        </a>
                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <span class="text-muted"><i class="fa fa-clock-o"></i> 2012-11-17</span>
                    </div>
                    	<h3 id="开闭原则">开闭原则</h3>

<p>对于程序员来说，一方面，由于需求是由客户提出的，无法控制需求的变化；另一方面，随着技术的进步和时代的发展，技术和商业一定会有着非常巨大的变化。这些变化，都会使得人们对软件的要求有变化。例如，最早，用电话线上网的时候，腾讯公司的qq软件只有文字聊天功能；之后，随着带宽的增加和需求的变化，qq软件增加了传送文件等功能；再之后，随着ADSL的兴起，如今的qq软件有了语音以及视频聊天、qq游戏、qq空间等等非常丰富的功能。这就是一个典型的需求不断变化的例子。<br /></p>

<p>因此我们发现，需求的变化是必然的，程序员只能去适应需求的变化。于是，人们延长软件寿命的工作重点放在了“避免修改代码”上。是啊，如果能够在不修改代码的情况下，满足新的需求，那么就能在最大程度上避免软件被“越改越乱”了。于是，软件行业提出了一个设计原则：“开闭原则”。<br /></p>

<p>这条原则指的是，在软件设计的过程中，要求软件能够做到：<code class="highlighter-rouge">对扩展开放，对修改关闭</code>！程序员可以通过在原有代码的基础上增加新代码的方式来满足新的需求，而不是修改原有的代码。如果一个软件能够做到这一点，那么软件的功能看可以自由扩展，从而应对需求的变化；而原有的部分保持成熟和稳定。这样能够更好地保持程序结构的清晰易懂。<br /></p>

<p>为了实现开闭原则，有一些更加具体的要求。例如，修改关闭，就意味着原有的代码，在新的扩展以后的系统中继续能够使用，也就是代码的“可重用性”；而扩展开放，就意味着新的代码能够很方便的扩展原有的系统，而不影响原有的代码，这也就是代码的“可扩展性”；为了能够达到开闭原则，就要求模块之间的联系应当尽可能的弱，这样才能够保证方便的扩展新功能而不影响其他功能。同时，我们应该能够根据不同的新需求，扩展相应的软件模块，这也就有了软件“各司其职”的要求，即：软件的不同模块在功能上应该有明确的职责划分。也就是说，为了实现开闭原则，我们的软件应该具备以下特点：<br /></p>

<ul>
  <li>可重用</li>
  <li>可扩展</li>
  <li>弱耦合</li>
  <li>各司职</li>
</ul>

<p>而这正是面型对象编程思想的特点和要求。举个例子，我们都知道中国古代的四大发明，分别是造纸术，指南针，火药和活字印刷术。这其中，造纸术、指南针和火药都是从无到有的发明，唯有活字印刷术比较特别，北宋时期的毕昇只是将原有的印刷术加以改进，发明了活字印刷术。这难道不奇怪吗？我们往往认为，技术的发明者要比技术的改良者更值得纪念。就像我们记住了灯泡的发明者是爱迪生，却淡忘了节能环保型灯泡的发明者。可是针对印刷术，谁又能说清印刷术的发明者是谁呢？我们记住的只是那个改良者—毕昇。	这不难理解，传统的印刷术，印刷工人要在一整块木板上刻下所有的文字。一个错字就可能使得整个版作废。而活字印刷术高明之处在于，将每个字做成独立的“个体”，由多个“个体”组成词语，句子。这样，当文字发生改变的时候，只需要替换或增加有改动的文字即可，使得印刷工作符合了“开闭原则”。具体的说，每个字是独立的个体，这符合“各司其职”的要求；做好的字可以反复使用，这符合“可重用性”的要求；字与字之间彼此独立，互不影响，这符合“弱耦合性”的要求；整个版面可以在不影响其他字的情况下，随意添加新的文字，这又符合了“可扩展性”的要求。总之我们可以戏称，活字印刷术位列四大发明，体现了开闭原则的价值，闪烁着面向对象的光芒。<br /></p>

<p>为了更好的使用面向对象思想，为了使得我们的程序更加符合开闭原则，下面介绍非常典型的软件职责划分的方法：<code class="highlighter-rouge">软件的三层体系结构</code>。<br /></p>

<p>在介绍三层体系结构之前，我们先分析一下之前提出的那些需求。我们可以把所有的需求分成三大类。<br /></p>

<ol>
  <li><code class="highlighter-rouge">第一类，数据从哪儿来</code>。之前提出的需求中，有的需求数据是从文件中读取，而有些情况，数据是从网络中读取。这一类需求的变化，是数据来源的变化，也可以认为是访问数据的方式的变化。</li>
  <li><code class="highlighter-rouge">第二类，数据怎么处理</code>。之前提出的需求中，数据获得之后，有些需求要求把数据全部转为了大写，有些需求要求把数据都转为倒置。这一类需求的变化，是对数据处理的变化，也可以认为是处理数据方式的变化。</li>
  <li><code class="highlighter-rouge">第三类，数据怎么显示</code>。在我们这些需求中，数据的显示比较简单，通过输出语句直接输出数据。但是我们可以想象，在以后的编程实践中，数据的显示会有各种各样的方式，例如通过图形界面显示，通过网页显示等等。</li>
</ol>

<p>本着各司其职的思想，我们把软件设计成三个层次。这三个层次分别对应于三类需求。<br /></p>

<ol>
  <li><code class="highlighter-rouge">首先是数据访问层</code>。数据访问层是用来和数据打交道，具体的说，负责数据的增加，删除，修改和查询（当然，在我们的例子中，只涉及数据的查询）。而数据访问层的对象，被称之为数据访问对象简称DAO。因此，数据访问层也被称为DAO层。DAO层对应着第一类需求：数据从哪儿来。</li>
  <li><code class="highlighter-rouge">其次是业务逻辑层</code>。业务逻辑层，是专门用来处理数据的，这一层的对象被称之为业务对象,简称BO。而数据访问层也被称为biz层。需要注意的是，业务逻辑层处理的数据，往往是从DAO层来的。也可以认为，DAO负责获取数据，然后把数据传递给biz层，让biz层对数据进行处理。</li>
  <li><code class="highlighter-rouge">最后是数据展示层</code>。用户提交的请求数据需要被接收，当数据处理完之后，结果数据需要显示给用户。而负责接收用户请求，并显示数据的是显示层，也被称为view层。而view层中的负责与用户交互的对象称之为View Object，简称VO。</li>
</ol>

<p>把软件分成三个层次之后，典型的情况如下：	view层与用户交互的过程中，接受用户的一个指令。如果view层用图形界面显示数据，则这个指令有可能是图形界面上的一次点击；如果view层用网页显示数据，则这个指令有可能是网页上发送的一个http请求。	当view层获得一个用户的指令之后，会把这个指令交给biz层。在view层中，VO会调用biz层中的方法，把用户跟view层交互时输入的一些数据，传递给biz层。然后，等biz层把数据处理完成之后，再把处理完成的数据返回给view层，让view层显示结果。	而biz层如果要处理数据，可能要先获得数据。为了获得数据，biz层需要调用dao层的方法。当dao层把数据获取之后，dao对象会将结果返回给biz层，biz层才能根据数据进行下一步的处理。<br /></p>

<p>因此，view、biz、dao三个层次之间，是从上到下依次调用方法的关系。示意为：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>       view&lt;-------&gt;biz&lt;-------&gt;dao
        |
        |
      client
</code></pre>
</div>

<p>我们以一个现实生活中的例子，来说明三层结构的概念。例如，一家汽车4S店，这种店为客户提供多种服务，例如购车、保养、修车等等。比如，客户的车坏了，需要修车。这个时候，当客户来到4S店时，与客户交互的往往是前台的接待员。这些接待员能够跟用户清晰、友好的沟通，获得客户的指令。我们可以把这些接待员当做就是view层中的VO。	当客户告诉接待员，“我需要修车”，这就相当于客户发送了一个指令给了VO。接待员知道用户需要修车之后，自己不会替用户完成修车这个过程。修车的指令，被接待员发送给了真正的汽车修理工。汽车哪部分有毛病，哪部分需要检修，这些数据都由接待员告诉修理工，由修理工真正来完成“修车”这个业务。在这个关系中，修理工就相当于biz层中的BO，而上述流程就相当于view层的VO调用biz层的BO的方法。	当修理工修车时，有可能需要进行零部件的更换。例如，可能需要更换发动机，为此，修理工必须要获得一个新的发动机。往往备用的零配件是存放在仓库中，而仓库显然不能让每个人都随意进行访问，往往公司会安排一个专人做仓库管理员。仓库管理员的职责，就是负责向仓库存放物资，以及从仓库中取出物资。如果我们把零配件当做数据，那么仓库管理员的工作就是存取数据，扮演的就是DAO的角色。而修理工修车时，会根据需要向管理员要零配件，可以认为这就是biz层的BO对象在调用dao层的DAO对象的方法。	当仓库管理员找到相应的零配件时，会把这些物品交给修理工；而当修理工修车完毕之后，会通知前台的接待员；接待员最后会把修好的车以及其他的一些信息（例如修车花了多少钱……）显示给客户。类比Java代码就是：dao层返回到biz层，biz层返回给view层，view层把运算的结果显示给客户。	
<br /><br /></p>

<h3 id="三层体系结构view-biz-dao的helloworld程序">三层体系结构(view-biz-dao)的HelloWorld程序</h3>

<p>上面我们介绍了软件的三层体系结构。那么，把软件设计成三层结构有什么好处呢？好处在于：当需求发生改变时，我们可以把改变局限在某个层次中，而不影响其他层次。例如，如果仓库的地点以及放置物品的位置发生改变的话，我们不需要对前台接待员和汽车修理工做过多的说明，只要让仓库保管员能够清楚应该怎么工作就可以了。同样的，如果某一个层次的需求发生变化，则我们只需要针对那个特定的层次，修改相应的代码，而不用改变其他层次的代码。<br />
为了让层次与层次之间，实现弱耦合性，我们使用接口来定义三个不同的层次。<br /></p>

<p>下面以HelloWorld程序为例，看一下如何应用三层体系结构。<br /></p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">//首先，应当定义三层的接口，先是Dao层的接口</span>
<span class="kn">package</span> <span class="n">dao</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Dao</span> <span class="o">{</span>
	<span class="n">String</span> <span class="nf">getData</span><span class="o">();</span> 
<span class="o">}</span> 

<span class="c1">//然后是biz层的接口。需要注意的是，因为biz层要调用dao层的方法，因此在biz对象中，需要维护一个Dao对象的引用。</span>
<span class="c1">//为此，所有Biz层接口的实现类都应当有一个Dao类型的属性，并提供一个setDao方法。因此，在Biz接口中，我们定义了setDao方法</span>
<span class="kn">package</span> <span class="n">biz</span><span class="err">；</span>
<span class="kn">import</span> <span class="nn">dao.Dao</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Biz</span> <span class="o">{</span>
	<span class="kt">void</span> <span class="nf">setDao</span><span class="o">(</span><span class="n">Dao</span> <span class="n">dao</span><span class="o">);</span>
	<span class="n">String</span> <span class="nf">dealData</span><span class="o">();</span>
<span class="o">}</span>

<span class="c1">//最后是view层的接口。与之前的情况类似，view层也应当有一个Biz类型的引用，用以调用biz层的方法。</span>
<span class="c1">//因此，在view接口中我们定义了setBiz方法</span>
<span class="kn">package</span> <span class="n">view</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">biz.Biz</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">View</span> <span class="o">{</span>
	<span class="kt">void</span> <span class="nf">setBiz</span><span class="o">(</span><span class="n">Biz</span> <span class="n">biz</span><span class="o">);</span>
	<span class="kt">void</span> <span class="nf">showData</span><span class="o">();</span>
<span class="o">}</span> 


<span class="c1">//定义完了三个接口以后，接下来应该给出的是接口的实现类。例如，我们首先给出Dao接口的实现类。</span>
<span class="c1">//假设我们希望从当前目录下的"Test.txt"文件中获取数据，则可以给出一个实现类：FileDaoImpl实现Dao接口，代码如下：</span>
<span class="kn">package</span> <span class="n">dao</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FileDaoImpl</span> <span class="kd">implements</span> <span class="n">Dao</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getData</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">FileInputStream</span> <span class="n">fin</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">"Test.txt"</span><span class="o">);</span>
			<span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="n">fin</span><span class="o">);</span>
			<span class="n">data</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
		<span class="o">}</span>
		<span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStacktrace</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">br</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">try</span> <span class="o">{</span>
					<span class="n">br</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
				<span class="o">}</span>
				<span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">data</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>

<span class="c1">//下面是Biz接口的实现。假设我们要实现把所有数据转换成大写的逻辑，则可以给出一个UpperCaseBizImpl的实现类，代码为</span>
<span class="kn">package</span> <span class="n">biz</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">dao.Dao</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UpperCaseBizImpl</span> <span class="kd">implements</span> <span class="n">Biz</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="n">Dao</span> <span class="n">dao</span><span class="o">;</span>
	
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">dealData</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dao</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">data</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">();</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">data</span><span class="o">;</span>
	<span class="o">}</span>
	
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDao</span><span class="o">(</span><span class="n">Dao</span> <span class="n">dao</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">dao</span> <span class="o">=</span> <span class="n">dao</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>

<span class="c1">//最后，view接口的实现比较简单，我们给出TextViewImpl的实现代码：</span>
<span class="kn">package</span> <span class="n">view</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">biz.BiZ</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TextViewImpl</span> <span class="kd">implements</span> <span class="n">View</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="n">Biz</span> <span class="n">biz</span><span class="o">;</span>
	
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBiz</span><span class="o">(</span><span class="n">Biz</span> <span class="n">biz</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">biz</span> <span class="o">=</span> <span class="n">biz</span><span class="o">;</span>
	<span class="o">}</span>
	
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">showData</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="n">biz</span><span class="o">.</span><span class="na">dealData</span><span class="o">();</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>



<span class="c1">//把三个接口实现完成之后，接下来就可以写主方法，设置类之间的关联关系。代码如下：</span>
<span class="kn">package</span> <span class="n">test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">dao.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">biz.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">view.*</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestMain</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="c1">//创建对象并调用set方法进行组装</span>
		<span class="n">Dao</span> <span class="n">dao</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileDaoImpl</span><span class="o">();</span>
		<span class="n">Biz</span> <span class="n">biz</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LowerCaseBizImpl</span><span class="o">();</span>
		<span class="n">biz</span><span class="o">.</span><span class="na">setDao</span><span class="o">(</span><span class="n">dao</span><span class="o">);</span>
		<span class="n">View</span> <span class="n">view</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TextViewImpl</span><span class="o">();</span>
		<span class="n">view</span><span class="o">.</span><span class="na">setBiz</span><span class="o">(</span><span class="n">biz</span><span class="o">);</span>
		
		<span class="n">view</span><span class="o">.</span><span class="na">showData</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<p>上述的设计”修改关闭”的要求就非常近了。 <br />
接近了”修改关闭”，但是依然会在需求变化的时候修改原有的代码，能不能完全不求该代码呢？<br /></p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">//首先，修改码的原因与创建对象相关。</span>
<span class="c1">//为此，我们可以利用简单工厂模式，把原有的创建对象的过程，都挪到一个简单工厂里面，工厂代码如下：</span>
<span class="kn">package</span> <span class="n">factory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">dao.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">biz.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">view.*</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleFactory</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="nf">SimpleFactory</span><span class="o">()</span> <span class="o">{</span>
		<span class="c1">//</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Dao</span> <span class="nf">createDao</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nf">FileDaoImpl</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Biz</span> <span class="nf">createBiz</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nf">UpperCaseBizImpl</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="n">pubblic</span> <span class="n">View</span> <span class="nf">createView</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nf">TextViewImpl</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

<span class="c1">//这样,TestMain程序就可以改成</span>
<span class="kn">package</span> <span class="n">test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">dao.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">biz.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">view.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">factory.SimpleFactory</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestMain</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">SimpleFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleFactory</span><span class="o">();</span>
		<span class="n">Dao</span> <span class="n">dao</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">createDao</span><span class="o">();</span>
		<span class="n">Biz</span> <span class="n">biz</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">createBiz</span><span class="o">();</span>
		<span class="n">biz</span><span class="o">.</span><span class="na">setDao</span><span class="o">(</span><span class="n">dao</span><span class="o">);</span>
		<span class="n">View</span> <span class="n">view</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">createView</span><span class="o">();</span>
		<span class="n">view</span><span class="o">.</span><span class="na">setBiz</span><span class="o">(</span><span class="n">biz</span><span class="o">);</span>
		
		<span class="n">view</span><span class="o">.</span><span class="na">showData</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

<span class="c1">//这样，当实现类改变的时候，主方法不需要改变，因为创建对象的代码都使用factory来完成了</span>
<span class="c1">//但是，这样如果需求改变的话，还是要该factory的代码。有没有办法不改代码，就能够在某个层次用一个实现类替换另一个实现类呢？</span>
<span class="c1">//我们知道，利用反射可以灵活的创建对象。使用Class.forName(String className)，通过一个字符串获得类对象。</span>
<span class="c1">//然后，通过类对象，可以创建一个相应类型的对象。简单的说，可以通过一个字符串，创建一个该类型的对象。而字符串，</span>
<span class="c1">//既可以写在代码中，同样可以从别的途径获得。例如，可以从一个配置文件中获得。</span>
<span class="c1">//因此，修改配置文件，就可以让class.forName获得不同的字符串，从而创建出不同类型的对象来。</span>
<span class="c1">//换句话说，我们可以通过配置文件+反射的方式，来完成对象的创建。</span>
<span class="c1">//这样，当我们需要修改实现类的时候，只需要修改配置文件，而完全不需要修改代码。</span>

<span class="c1">//为此，我们可以为SimpleFactory增加一个Properties的属性，并且在构造方法中，</span>
<span class="c1">//利用load方法，读入conf.props。完整的SimpleFactory代码如下：</span>
<span class="kn">package</span> <span class="n">factory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">dao.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">biz.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">view.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Properties</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleFactory</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="n">Properties</span> <span class="n">props</span><span class="o">;</span>
	<span class="kd">public</span> <span class="nf">SimpleFactory</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
		<span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span><span class="o">{</span>
			   <span class="n">is</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">"conf.props"</span><span class="o">);</span>
			   <span class="n">props</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
		   <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">){</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>
		<span class="k">finally</span><span class="o">{</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">is</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
				<span class="k">try</span><span class="o">{</span>
					<span class="n">is</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
				<span class="o">}</span>
				<span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
					<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="n">Dao</span> <span class="nf">createDao</span><span class="o">(){</span>
		<span class="n">String</span> <span class="n">className</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"dao"</span><span class="o">);</span>
		<span class="n">Dao</span> <span class="n">dao</span> <span class="o">=</span> <span class="o">(</span><span class="n">Dao</span><span class="o">)</span> <span class="n">createObject</span><span class="o">(</span><span class="n">className</span><span class="o">);</span>
		<span class="k">return</span> <span class="n">dao</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="n">Biz</span> <span class="nf">createBiz</span><span class="o">(){</span>
		<span class="n">String</span> <span class="n">className</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"biz"</span><span class="o">);</span>
		<span class="n">Biz</span> <span class="n">biz</span> <span class="o">=</span> <span class="o">(</span><span class="n">Biz</span><span class="o">)</span> <span class="n">createObject</span><span class="o">(</span><span class="n">className</span><span class="o">);</span>
		<span class="k">return</span> <span class="n">biz</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">View</span> <span class="nf">createView</span><span class="o">(){</span>
		<span class="n">String</span> <span class="n">className</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"view"</span><span class="o">);</span>
		<span class="n">View</span> <span class="n">view</span> <span class="o">=</span> <span class="o">(</span><span class="n">View</span><span class="o">)</span> <span class="n">createObject</span><span class="o">(</span><span class="n">className</span><span class="o">);</span>
		<span class="k">return</span> <span class="n">view</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">private</span> <span class="n">Object</span> <span class="nf">createObject</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">){</span>
		<span class="n">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">Class</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span> 
		<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>

<span class="c1">//配置conf,props文件如下：</span>
<span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="o">.</span><span class="na">TextViewImpl</span>
<span class="n">biz</span><span class="o">=</span><span class="n">biz</span><span class="o">.</span><span class="na">UpperCaseBizImpl</span>
<span class="n">dao</span><span class="o">=</span><span class="n">dao</span><span class="o">.</span><span class="na">FileDaoImpl</span>

<span class="c1">//test.txt文件内容如下：</span>
<span class="n">Hello</span> <span class="n">World</span>


<span class="c1">//当上述简单工厂完成之后，运行结果如下：</span>
<span class="n">HELLO</span> <span class="n">WORLD</span>

<span class="c1">//而当有新需求，希望把所有字符改成小写，只需要修改配置文件即可：</span>
<span class="n">biz</span><span class="o">=</span><span class="n">biz</span><span class="o">.</span><span class="na">LowerCaseBizImpl</span>
</code></pre>
</div>

<p>读者也可以在该代码上，尝试着完成其他的一些需求。例如：文字从网络中获取（改变的是数据的获取方式，需要为Dao接口添加一个实现类，替换掉FileDaoImpl）；将文字倒置处理（改变的是数据的处理方式，需要为Biz接口添加一个实现类，替换LowerCaseBizImpl）。<br /></p>

<p>也许读者会迷惑，写了这么多的接口和类，最终只是完成了最初级的HelloWorld输出的功能，是不是有点小题大做了？诚然，这个程序的功能并不复杂，但这种程序结构，使得在需求变化的时候，我们总是能够有针对性的扩展出某个接口的实现类，而不需要改动任何原有代码，从而保证了开闭原则的要求，也使得我们的代码能够“健康长寿”。我们可以认为，这才是一个真正贯彻了面向对象思想，发挥了面向对象优势的HelloWorld！	<br /></p>


                    <hr>
                    <div class="row">
                        <div class="col-md-6">
                                <h5 style="display: inline;">Tags:</h5>
                                
                                    <button class="btn btn-white btn-xs" type="button">java</button>
                                
                        </div>
                        
                        <!--
                        <div class="col-md-6">
                            <div class="small text-right">
                                <div>    
                                    <i class="fa fa-comments-o"> </i> 
                                    <span class="ds-comments">0</span>条评论
                                </div>
                                <div>
                                    <i class="fa fa-share-alt"> </i> 
                                    <span class="ds-shares">0</span>条转发
                                </div>  
                            </div>
                        </div>
                        -->
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-lg-12">
                            <!-- donate -->
                            
                                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal2">
    Donate
</button>
<div class="modal inmodal" id="myModal2" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content animated flipInY">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">Donate Me</h4>
                <small class="font-bold">Thanks for your support!</small>
            </div>
            <div class="modal-body">
                <div class="tabbable" id="tabs-960227">
                    <ul class="nav nav-tabs">
                        <li class="active">
                            <a href="#panel-405278" data-toggle="tab">Alipay</a>
                        </li>
                        <li>
                            <a href="#panel-874705" data-toggle="tab">Wechat</a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane active" id="panel-405278">
                            <div class="text-center">
                                <img src="/static/img/pay/alipay.png"" height="250" width="250">
                            </div>    
                        </div>
                        <div class="tab-pane" id="panel-874705">
                            <div class="text-center">
                                <img src="/static/img/pay/wechat.png"" height="250" width="250">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

                            
                            <br>
                            <!-- share -->
                            
                                
<!--分享-->
<div class="row" style="margin-top:30px;">
	<h2>Share:</h2>
    <div class="social-share" style="margin-left:-5px;"data-sites="wechat,qq,qzone,weibo"></div> 
</div>
<link rel="stylesheet" href="/static/css/share.min.css">
<script src="/static/js/jquery.share.min.js"></script>
<script src="/static/js/embed.js"></script>

<script>
  var url = 'http://localhost:4000/java/2012/11/17/java-mvc-base.html';
  var source = 'http://localhost:4000/java/2012/11/17/java-mvc-base.html';
  var title = 'javaee软件设计的基本原则';
  var excerpt = $("p:eq(0)").text();
  
  var imageUrl = 'http://localhost:4000/static/img/landing/header_one.jpg';
  var imgEle = $(".content_img:eq(0)");
  if (imgEle) {
    imageUrl = imgEle.attr("src");
  }

  var $config = {
      url: url, // 网址，默认使用 window.location.href
      source: source, // 来源（QQ空间会用到）, 默认读取head标签：<meta name="site" content="http://overtrue" />
      title: title, // 标题，默认读取 document.title 或者 <meta name="title" content="share.js" />
      description: excerpt, // 描述, 默认读取head标签：<meta name="description" content="PHP弱类型的实现原理分析" />
      image: imageUrl, // 图片, 默认取网页中第一个img标签
      sites: ['qzone', 'qq', 'weibo','wechat','douban'], // 启用的站点
      //disabled: ['google', 'facebook', 'twitter'], // 禁用的站点
      wechatQrcodeTitle: "微信扫一扫：分享", // 微信二维码提示文字
      wechatQrcodeHelper: '<p style="font-size:10px;">微信里点“发现”，扫一下</p><p style="font-size:10px;">二维码便可将本文分享至朋友圈。</p>',
   };
  $('.social-share').share($config);
</script>




                            
                            <br>
                            <!-- comment -->
                            <!--



-->

<!-- 多说评论框 start -->
<div class="row" style="margin-top:25px;"></div>
<div class="ds-thread" data-thread-key="/java/2012/11/17/java-mvc-base.html" data-title="javaee软件设计的基本原则" data-url="http://localhost:4000/java/2012/11/17/java-mvc-base.html"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
	var duoshuoQuery = {short_name:"kinglyjn"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
</script>
<!-- 多说公共JS代码 end -->



                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

</div>



	
	    <script src="/static/js/scroll.js"></script>

<!-- Baidu analytics -->


<!-- Google analytics -->

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-73784599-1', 'auto');
    ga('send', 'pageview');

  </script>


<!--

-->

<!--

-->

<script async src="/static/js/count_page.js"></script>

	

</body>
</html>